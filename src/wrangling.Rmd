---
title: "otters wrangling"
author: "lor + cat"
date: "2/18/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)
library(tidyverse)
library(here)
library(janitor)
library(lubridate)
library(kableExtra)
```

```{r}
# reading in data + some cleaning up 
otters <- read.csv(here("data", "2018_Foraging.csv")) %>% 
  clean_names() %>% 
  mutate(date = mdy(date)) %>% 
  rename(aerial_survey_yr = year) # i know you probably hate this name LOL but i only renamed it because this is a DIFFERENT THING than the date; i was getting confused as to why the date and year columns had diff years listed so i just want to make that clear
```

```{r}
# WIDGET 2 STUFF

# to create a histogram of counts of prey obtained we would just need the prey item, success of dive (which indicates if dive is brought to surface or not), and prey quantity to determine the number of prey successfully caught 
prey <- otters %>% 
  select(suc, prey_item, date, age, prey_qty) %>% 
  group_by(prey_item) %>% 
  count(suc, wt = prey_qty) %>% 
  rename(prey_caught = n) %>% 
  filter(suc == "Y")

# example plot with all a couple prey shown: widget selection would be CLA, SAG, UNK
top_prey <- prey %>% 
  filter(prey_item == "CLA" |
           prey_item == "SAG" |
           prey_item == "UNK")

ggplot(data = top_prey, aes(x = prey_item, y = prey_caught)) +
  geom_col()
```


```{r}
age_sex <- otters %>% 
  filter(sex == "F" | sex == "M") %>% 
  filter(age == "J" | age == "A")

otter_stats <- age_sex %>% 
  group_by(sex, age) %>% 
  summarise(dive_time = round(mean(dt, na.rm = TRUE),2),
            prey_quantity = round(mean(prey_qty, na.rm = TRUE), 2) 
            )

otter_stats %>% 
   kable(col.names = c("Sex", "Age", "Mean Dive Time (seconds)", "Mean Prey Quantity")) %>% 
  kable_styling(bootstrap_options = "striped", full_width = FALSE)
  
```



